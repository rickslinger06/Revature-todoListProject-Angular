<!-- Fullscreen Backdrop Overlay -->
<div class="position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50 
     d-flex align-items-center justify-content-center" style="z-index: 9999;">

    <!-- Modal Card -->
    <div class="card shadow p-3 bg-white" style="max-width: 450px; width: 90%; border-radius: 10px;">

        <!-- HEADER -->
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="mb-0">Edit Subtask</h5>
            <button type="button" class="btn-close" aria-label="Close" (click)="cancel()"></button>
        </div>

        <!-- BODY -->
        <form [formGroup]="form">
            <div class="mb-3">
                <label class="form-label">Description</label>

                <div class="text-end small text-muted">
                    {{ form.get('description')?.value?.length || 0 }} / 120
                </div>

                <textarea class="form-control" formControlName="description" placeholder="Edit subtask description"
                    rows="3" maxlength="120">
        </textarea>

                @if (form.get('description')?.touched && form.get('description')?.invalid) {
                <div class="text-danger mt-1">
                    Description is required.
                </div>
                }

                @if (form.get('description')?.touched && form.get('description')?.hasError('maxlength')) {
                <div class="text-danger mt-1">
                    Maximum 120 characters allowed.
                </div>
                }
            </div>
        </form>

        <!-- ERROR -->
        @if (errorMessage) {
        <div class="alert alert-danger mt-2">
            {{ errorMessage }}
        </div>
        }

        <!-- FOOTER -->
        <div class="d-flex justify-content-end gap-2 mt-3">
            <button type="button" class="btn btn-outline-secondary" (click)="cancel()">Cancel</button>

            <button type="button" class="btn btn-primary" [disabled]="form.invalid" (click)="save()">

                @if (!loading) { <span>Update</span> }
                @if (loading) { <span>Saving...</span> }
            </button>
        </div>

    </div>
</div>